<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Hands-On with SQL Code | Intro to SQL for Querying Databases</title>
  <meta name="description" content="4 Hands-On with SQL Code | Intro to SQL for Querying Databases" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Hands-On with SQL Code | Intro to SQL for Querying Databases" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_intro_to_sql" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Hands-On with SQL Code | Intro to SQL for Querying Databases" />
  
  
  

<meta name="author" content="Michele Tobias" />
<meta name="author" content="Nicholas Alonzo" />
<meta name="author" content="Nick Ulle" />


<meta name="date" content="2024-04-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="database-set-up.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Intro to SQL for Querying Databases</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="concepts.html"><a href="concepts.html"><i class="fa fa-check"></i><b>1</b> Concepts</a>
<ul>
<li class="chapter" data-level="1.1" data-path="concepts.html"><a href="concepts.html#what-is-a-relational-database"><i class="fa fa-check"></i><b>1.1</b> What is a Relational Database?</a></li>
<li class="chapter" data-level="1.2" data-path="concepts.html"><a href="concepts.html#what-is-sql"><i class="fa fa-check"></i><b>1.2</b> What is SQL?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="concepts.html"><a href="concepts.html#what-kinds-of-questions-can-sql-answer"><i class="fa fa-check"></i><b>1.2.1</b> What kinds of questions can SQL answer?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="concepts.html"><a href="concepts.html#what-is-a-relational-database-management-system"><i class="fa fa-check"></i><b>1.3</b> What is a Relational Database Management System?</a></li>
<li class="chapter" data-level="1.4" data-path="concepts.html"><a href="concepts.html#advantages-disadvantages-of-sql"><i class="fa fa-check"></i><b>1.4</b> Advantages &amp; Disadvantages of SQL</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-library-checkouts-database.html"><a href="the-library-checkouts-database.html"><i class="fa fa-check"></i><b>2</b> The Library Checkouts Database</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-library-checkouts-database.html"><a href="the-library-checkouts-database.html#entity-relationship-diagrams"><i class="fa fa-check"></i><b>2.1</b> Entity Relationship Diagrams</a></li>
<li class="chapter" data-level="2.2" data-path="the-library-checkouts-database.html"><a href="the-library-checkouts-database.html#data-definitions"><i class="fa fa-check"></i><b>2.2</b> Data Definitions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="database-set-up.html"><a href="database-set-up.html"><i class="fa fa-check"></i><b>3</b> Database Set Up</a>
<ul>
<li class="chapter" data-level="3.1" data-path="database-set-up.html"><a href="database-set-up.html#sqlitestudio"><i class="fa fa-check"></i><b>3.1</b> SQLiteStudio</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="database-set-up.html"><a href="database-set-up.html#create-a-database"><i class="fa fa-check"></i><b>3.1.1</b> Create a Database</a></li>
<li class="chapter" data-level="3.1.2" data-path="database-set-up.html"><a href="database-set-up.html#load-the-database"><i class="fa fa-check"></i><b>3.1.2</b> Load the Database</a></li>
<li class="chapter" data-level="3.1.3" data-path="database-set-up.html"><a href="database-set-up.html#saving-scripts"><i class="fa fa-check"></i><b>3.1.3</b> Saving Scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html"><i class="fa fa-check"></i><b>4</b> Hands-On with SQL Code</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#viewing-data"><i class="fa fa-check"></i><b>4.1</b> Viewing Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#select-from"><i class="fa fa-check"></i><b>4.1.1</b> SELECT &amp; FROM</a></li>
<li class="chapter" data-level="4.1.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#selecting-columns"><i class="fa fa-check"></i><b>4.1.2</b> Selecting Columns</a></li>
<li class="chapter" data-level="4.1.3" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#unique-values"><i class="fa fa-check"></i><b>4.1.3</b> Unique Values</a></li>
<li class="chapter" data-level="4.1.4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#ordering-results"><i class="fa fa-check"></i><b>4.1.4</b> Ordering Results</a></li>
<li class="chapter" data-level="4.1.5" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#limiting-number-of-rows"><i class="fa fa-check"></i><b>4.1.5</b> Limiting Number of Rows</a></li>
<li class="chapter" data-level="4.1.6" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#commenting"><i class="fa fa-check"></i><b>4.1.6</b> Commenting</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#filtering-data"><i class="fa fa-check"></i><b>4.2</b> Filtering Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#and-or-operators"><i class="fa fa-check"></i><b>4.2.1</b> AND &amp; OR Operators</a></li>
<li class="chapter" data-level="4.2.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#in-operator"><i class="fa fa-check"></i><b>4.2.2</b> IN Operator</a></li>
<li class="chapter" data-level="4.2.3" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#between-operator"><i class="fa fa-check"></i><b>4.2.3</b> BETWEEN Operator</a></li>
<li class="chapter" data-level="4.2.4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#like-operator"><i class="fa fa-check"></i><b>4.2.4</b> LIKE Operator</a></li>
<li class="chapter" data-level="4.2.5" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#is-null-operator"><i class="fa fa-check"></i><b>4.2.5</b> IS NULL Operator</a></li>
<li class="chapter" data-level="4.2.6" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#not-operator"><i class="fa fa-check"></i><b>4.2.6</b> NOT Operator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#aggregating-data"><i class="fa fa-check"></i><b>4.3</b> Aggregating Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#count"><i class="fa fa-check"></i><b>4.3.1</b> Count</a></li>
<li class="chapter" data-level="4.3.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#average"><i class="fa fa-check"></i><b>4.3.2</b> Average</a></li>
<li class="chapter" data-level="4.3.3" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#sum"><i class="fa fa-check"></i><b>4.3.3</b> Sum</a></li>
<li class="chapter" data-level="4.3.4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#grouping-data"><i class="fa fa-check"></i><b>4.3.4</b> Grouping Data</a></li>
<li class="chapter" data-level="4.3.5" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#having"><i class="fa fa-check"></i><b>4.3.5</b> Having</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#joining-data"><i class="fa fa-check"></i><b>4.4</b> Joining Data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#join-types"><i class="fa fa-check"></i><b>4.4.1</b> JOIN Types</a></li>
<li class="chapter" data-level="4.4.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#join-steps"><i class="fa fa-check"></i><b>4.4.2</b> JOIN steps</a></li>
<li class="chapter" data-level="4.4.3" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#inner-join"><i class="fa fa-check"></i><b>4.4.3</b> INNER JOIN</a></li>
<li class="chapter" data-level="4.4.4" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#left-join"><i class="fa fa-check"></i><b>4.4.4</b> LEFT JOIN</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#subqueries"><i class="fa fa-check"></i><b>4.5</b> Subqueries</a></li>
<li class="chapter" data-level="4.6" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#saving-query-results"><i class="fa fa-check"></i><b>4.6</b> Saving Query Results</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#connecting-databases-to-other-analysis-tools"><i class="fa fa-check"></i><b>4.6.1</b> Connecting Databases to Other Analysis Tools</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#data-management"><i class="fa fa-check"></i><b>4.7</b> Data Management</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#update-tables"><i class="fa fa-check"></i><b>4.7.1</b> Update Tables</a></li>
<li class="chapter" data-level="4.7.2" data-path="hands-on-with-sql-code.html"><a href="hands-on-with-sql-code.html#add-populate-a-column"><i class="fa fa-check"></i><b>4.7.2</b> Add &amp; Populate a Column</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>5</b> Conclusion</a></li>
<li class="chapter" data-level="6" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>6</b> Resources</a></li>
<li class="divider"></li>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg" style="float: right; padding-right: 10px;" />
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to SQL for Querying Databases</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hands-on-with-sql-code" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Hands-On with SQL Code<a href="hands-on-with-sql-code.html#hands-on-with-sql-code" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We just learned that SQL is a language that allows us to interact with and manage a database. Let’s learn some SQL queries to get some hands-on experience.</p>
<div id="viewing-data" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Viewing Data<a href="hands-on-with-sql-code.html#viewing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="select-from" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> SELECT &amp; FROM<a href="hands-on-with-sql-code.html#select-from" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’re ready to write our first queries! The most common query you’ll use is the SELECT statement. In it’s most basic form, it shows you the data in a table, but you can add option to customize the view you get back. Let’s try! Type this query into the query box:</p>
<p><code>SELECT * FROM items;</code></p>
<p>Now click the <em>Execute all</em> button. <img src="images/Button_Execute.PNG" alt="alt text" /></p>
<p>This query asks the database to select everything (* means “everything”) from the table <em>items</em>. It ends with a semicolon to tell the database that this is the end of our request.</p>
<pre><code>SELECT 
* 
FROM 
items;</code></pre>
<p>The above query does exactly the same thing as the first one, hence the need for the end of query indicator. We can use new lines to help us organize large queries to make them easier to read.</p>
<p>SQL ignores capitalization, spaces, and new lines in a query. Some tools which
use SQL also ignore semicolons. However, it’s conventional to:</p>
<ul>
<li>Write SQL keywords (<code>SELECT</code>, <code>FROM</code>, and so on) in UPPERCASE</li>
<li>Write table and column names in lowercase</li>
<li>Write a semicolon <code>;</code> at the end of the query</li>
</ul>
</div>
<div id="selecting-columns" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Selecting Columns<a href="hands-on-with-sql-code.html#selecting-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>items</em> table has a lot of columns. What if we don’t want to see all of the columns in the table? We can ask for just the columns we want to see. Let’s get just the item ID, title, and material type.</p>
<pre><code>SELECT
    item_id,
    title,
    material_type
FROM items;</code></pre>
<blockquote>
<p><strong>NOTE</strong>:<br />
You can order the columns however you’d like in the <code>SELECT</code> statement and select a column multiple times.</p>
</blockquote>
</div>
<div id="unique-values" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Unique Values<a href="hands-on-with-sql-code.html#unique-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What if we now want to knowwhat all the possible languages are in our data set? We could scroll through the results and try to keep track of unique values, but that is tedious - and we’ll likely miss some, especially if they are uncommon.</p>
<p>Instead we can use the <code>SELECT DISTINCT</code> keywords on one or more columns to show
all the unique values.</p>
<p>Let’s look at the <em>items</em> table again and see which languages our items are published in.</p>
<pre><code>SELECT DISTINCT language_code
FROM items;</code></pre>
<p>If we wanted to see unique combinations across multiple columns, we just add the columns we’re interested in. Let’s see which languages each publisher publishes in:</p>
<pre><code>SELECT DISTINCT 
    language_code,
    publisher
FROM items;</code></pre>
</div>
<div id="ordering-results" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Ordering Results<a href="hands-on-with-sql-code.html#ordering-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes sorting data is useful for understanding the output of a query.</p>
<p>With SQL, you can sort on one or more columns with a combination of ascending or descending order using the <code>ORDER BY</code> keyword.</p>
<p>Let’s sort the <em>items</em> table by the year of first publication.</p>
<pre><code>SELECT 
    title,
    author,
    first_publication_year
FROM items
ORDER BY first_publication_year;</code></pre>
<p>By default, <code>ORDER BY</code> sorts in ascending order. We can sort in descending order to get users born more recently by adding <code>DESC</code> after the column.</p>
<pre><code>SELECT 
    title,
    author,
    first_publication_year
FROM items
ORDER BY first_publication_year DESC;</code></pre>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
How would you sort <em>items</em> by author in descending order?</p>
</blockquote>
</div>
<div id="limiting-number-of-rows" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Limiting Number of Rows<a href="hands-on-with-sql-code.html#limiting-number-of-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes you’ll be working with a large table to analyze with lots of columns and rows. You can use <code>LIMIT</code> to reduce the number of rows the query returns to give you a snapshot of the data you’re working with. Limiting the output is particularly useful when you are building a complex query on a large amount of data. Limiting makes the query quicker so you can see an example of the results more quickly for troubleshooting. Once your limited query returns the results you want, then you can run the full query.</p>
<pre><code>SELECT *
FROM items
LIMIT 10;</code></pre>
</div>
<div id="commenting" class="section level3 hasAnchor" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Commenting<a href="hands-on-with-sql-code.html#commenting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we’re writing queries, sometimes we want to write helpful comments to ourselves and others. There’s two ways to write comments so that text won’t be interpreted as SQL.</p>
<ol style="list-style-type: decimal">
<li>Single line comments: text following two dashses “<em>–</em>”: <code>-- comment here</code></li>
<li>Multiline comments: text between the characters “<em>/* */</em>”: <code>/* comment here */</code></li>
</ol>
<!--- * --->
<pre><code>/*
all items in the library system 
sorted by first publication year
*/
SELECT 
    title,
    author,
    first_publication_year
FROM items
ORDER BY first_publication_year DESC; -- sort most recent to the top</code></pre>
</div>
</div>
<div id="filtering-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Filtering Data<a href="hands-on-with-sql-code.html#filtering-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve seen some ways to view our data, let’s learn how we can filter our data. This is really the core of SQL, where we can start to answer our own questions about the data!</p>
<p>We use the <code>WHERE</code> clause to filter rows of a query by specifying one or more
conditions. <code>WHERE</code> in this case does not indicate a location. The table below shows comparison operators that can be used and combined with <code>WHERE</code> to create conditions, some of which you may have seen before in other programming languages.</p>
<table>
<thead>
<tr class="header">
<th align="left">Comparison Operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>=</code></td>
<td align="left">equals</td>
</tr>
<tr class="even">
<td align="left"><code>&gt;</code></td>
<td align="left">greater than</td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;=</code></td>
<td align="left">greater than or equal to</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;</code></td>
<td align="left">less than</td>
</tr>
<tr class="odd">
<td align="left"><code>&lt;=</code></td>
<td align="left">less than or equal to</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;&gt;</code> or <code>!=</code></td>
<td align="left">not equal to</td>
</tr>
</tbody>
</table>
<p>In general, the type of data on each side of the operator needs to be the same:
compare numbers to numbers, text to text, and so on. When working with <strong>text</strong>
or <strong>date</strong> data, it’s necessary to wrap values in single quotes. For instance:</p>
<ul>
<li><code>'text_value'</code> is a text value</li>
<li><code>'2000-01-01'</code> is a date</li>
</ul>
<p>Now let’s write a query to find items checked out from Shields Library:</p>
<pre><code>SELECT * 
FROM checkouts
WHERE library_code = &#39;SHLDS&#39;;</code></pre>
<blockquote>
<p><strong>NOTE</strong>:
Some relational database query tools require LIKE for text comparisons rather than =.</p>
</blockquote>
<p>SQL also provides a variety of arithmetic operators for working with numeric
data:</p>
<table>
<thead>
<tr class="header">
<th align="left">Arithmetic Operators</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>+</code></td>
<td align="left">addition</td>
</tr>
<tr class="even">
<td align="left"><code>-</code></td>
<td align="left">subtraction</td>
</tr>
<tr class="odd">
<td align="left"><code>*</code></td>
<td align="left">multiplication</td>
</tr>
<tr class="even">
<td align="left"><code>/</code></td>
<td align="left">division</td>
</tr>
<tr class="odd">
<td align="left"><code>%</code></td>
<td align="left">modulus</td>
</tr>
</tbody>
</table>
<div id="and-or-operators" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> AND &amp; OR Operators<a href="hands-on-with-sql-code.html#and-or-operators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often we’ll need to filter data based on more than one condition. We can ask
<code>WHERE</code> to check multiple conditions with the keywords:</p>
<ul>
<li><code>AND</code>, meaning a row must satisfy both conditions</li>
<li><code>OR</code>, meaning a row must satisfy at least one of two conditions</li>
</ul>
<p>These are logical operators in SQL that evaluate to TRUE or FALSE.</p>
<p>Let’s find all the items that have been checked out from Shields Library and the Law Library.</p>
<pre><code>SELECT * 
FROM checkouts
WHERE library_code = &#39;SHLDS&#39; AND
      library_code = &#39;LAW&#39;;</code></pre>
<p>You might have guessed that this query would return no records because a physical book cannot be checked in to two libraries at once.</p>
<p>Let’s find all the items that have been checked out from the New Books shelf <em>or</em> Shields Library.</p>
<pre><code>SELECT * 
FROM checkouts
WHERE library_code = &#39;SHLDS&#39; OR
      library_code = &#39;LAW&#39;;</code></pre>
<p>This query returns many books because we’re asking for all the items in both libraries. These last two queries should help illustrate the difference between <code>AND</code> and <code>OR</code>.</p>
<blockquote>
<p><strong>NOTE</strong>:<br />
<code>AND</code> &amp; <code>OR</code> will follow the order of operations. To use <code>AND</code> &amp; <code>OR</code> in the same query, wrap parenthesis around the <code>OR</code> conditions.</p>
</blockquote>
</div>
<div id="in-operator" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> IN Operator<a href="hands-on-with-sql-code.html#in-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes we find ourselves writing multiple <code>OR</code> conditions on the same column which can make our query look more complex than it really is. In this scenario we can condense multiple <code>OR</code> conditions using <code>IN</code>.</p>
<p>Let’s rewrite our previous query to use <code>IN</code>.</p>
<pre><code>SELECT * 
FROM checkouts
WHERE library_code IN (&#39;SHLDS&#39;, &#39;LAW&#39;);</code></pre>
</div>
<div id="between-operator" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> BETWEEN Operator<a href="hands-on-with-sql-code.html#between-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also also filter using ranges of values with <code>BETWEEN</code>. This is handy when you’re working with numerical or date values and you don’t want to list out all possible values to meet your conditions.</p>
<p>Let’s write a query to find all of the due dates for 2020.</p>
<pre><code>SELECT * 
FROM checkouts
WHERE due_date BETWEEN &#39;2020-01-01&#39; AND &#39;2020-12-31&#39;;</code></pre>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
How many items checked out (loan_date) for 2019? How many in 2020?</p>
</blockquote>
</div>
<div id="like-operator" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> LIKE Operator<a href="hands-on-with-sql-code.html#like-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>LIKE</code> keyword tests whether text values match a given pattern. There are two different wildcard characters that you can use in the pattern:</p>
<ul>
<li><code>_</code> matches exactly one character</li>
<li><code>%</code> matches zero or more characters</li>
</ul>
<p>Let’s look at an example to indicate we want to match the beginning of a string, but the end is allowed to vary. To show this, let’s find items with a publisher name that starts with “Springer” but can end with anything.</p>
<pre><code>SELECT * 
FROM items
WHERE publisher LIKE &#39;Springer%&#39;;</code></pre>
<blockquote>
<p><strong>NOTE</strong>:<br />
The wildcard <code>%</code> can be used multiple times in one pattern.</p>
<p>You can also use regular expressions in SQLite to match in more complicated
situations. Read more about using regular expressions
<a href="https://www.sqlite.org/lang_expr.html#regexp">here</a>.</p>
<p>The LIKE keyword differs between dialects of SQL, so it’s also a good idea to check the documentation for your RDBMS before using LIKE.</p>
</blockquote>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
Write a query that selects all the items whose publisher has the word “University” in their name?</p>
</blockquote>
</div>
<div id="is-null-operator" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> IS NULL Operator<a href="hands-on-with-sql-code.html#is-null-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we’ve worked with complete data, but how do we work with missing data? In databases, <code>NULL</code> means missing data. <code>IS NULL</code> is used to test whether there is missing data in a column.</p>
<p>Let’s look at an example to find items where the year of first publication is missing.</p>
<pre><code>SELECT * 
FROM items
WHERE first_publication_year IS NULL;</code></pre>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
How would you write a query to find items with a missing author name?</p>
</blockquote>
</div>
<div id="not-operator" class="section level3 hasAnchor" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> NOT Operator<a href="hands-on-with-sql-code.html#not-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There will be times where we want to find only the rows that do not satisfy some condition. To do this, use <code>NOT</code> combined with other operators:</p>
<ul>
<li><code>NOT IN</code></li>
<li><code>NOT BETWEEN</code></li>
<li><code>NOT LIKE</code></li>
<li><code>IS NOT NULL</code></li>
</ul>
<p>Below is a query to find items that <strong><em>do not</em></strong> have a certain number of recalls - in this case, we’re excluding items with 0, 1, or 3 recalls.</p>
<pre><code>SELECT * 
FROM items
WHERE recalls NOT IN (0, 1, 3);</code></pre>
</div>
</div>
<div id="aggregating-data" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Aggregating Data<a href="hands-on-with-sql-code.html#aggregating-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve just looked at a number of ways to filter data, but now let’s look at some ways to aggregate data.</p>
<div id="count" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Count<a href="hands-on-with-sql-code.html#count" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we want to find out how many items we have in the items table.</p>
<p>We can count the total number of rows in a table using the <code>COUNT</code> function. The function takes a column or <code>*</code> as an argument, but the argument doesn’t actually affect the count.</p>
<p>Here’s how we can use <code>COUNT</code> to answer our question:</p>
<pre><code>SELECT 
    COUNT(item_id)
FROM items;</code></pre>
<blockquote>
<p><strong>NOTE</strong>:<br />
You can combine <code>DISTINCT</code> with <code>COUNT</code> using <code>COUNT(DISTINCT column_name)</code>
to get a unique count of values in a column when duplicate values exist.</p>
</blockquote>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
Find the total number of patrons that have checked out a book.</p>
</blockquote>
<div id="renamingaliasing-columns" class="section level4 hasAnchor" number="4.3.1.1">
<h4><span class="header-section-number">4.3.1.1</span> Renaming/Aliasing Columns<a href="hands-on-with-sql-code.html#renamingaliasing-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the previous query, notice that the name of the column in the result is
<code>COUNT(id)</code>, which isn’t easy to use in subsequent SQL queries or with other
data programming tools.</p>
<p>We can use <code>AS</code> to rename or <strong>alias</strong> a column in the result of the query.
This is handy if you’re planning to export the result for future use,
especially if you’re sending it to someone else.</p>
<p>In our last query, let’s rename the column to <code>total_items</code>:</p>
<pre><code>SELECT 
    COUNT(item_id) AS total_items
FROM items;</code></pre>
</div>
</div>
<div id="average" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Average<a href="hands-on-with-sql-code.html#average" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>AVG</code> function returns the average value of a numeric column. Let’s find
the average number of recalls placed on items:</p>
<pre><code>SELECT 
    AVG(recalls) AS avg_recalls
FROM items;</code></pre>
</div>
<div id="sum" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Sum<a href="hands-on-with-sql-code.html#sum" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also sum the values in a numeric column with the <code>SUM</code> function. Let’s
find the total number of loans from outside:</p>
<pre><code>SELECT 
    SUM(loans_not_in_house) AS outside_loans
FROM items;</code></pre>
</div>
<div id="grouping-data" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Grouping Data<a href="hands-on-with-sql-code.html#grouping-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So now you’ve seen several functions working on a single column, but we
sometimes want to summarize our data in more sophisticated ways. Let’s see what
grouping can do for our data. Let’s write a query that counts the number of
books checked out at each library:</p>
<pre><code>SELECT 
    library_code, 
    COUNT(item_id) AS books_checked_out
FROM checkouts
GROUP BY library_code;</code></pre>
<p>Notice here how we asked for two columns - the <code>library_code</code> and the count of
<code>item_id</code>.</p>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
You can also <code>GROUP BY</code> more than one column by listing the columns to group by with each column name separated by a comma. How would you find the total number of times a patron checked out in each library?</p>
</blockquote>
</div>
<div id="having" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Having<a href="hands-on-with-sql-code.html#having" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>HAVING</code> is similar to <code>WHERE</code>, but it specifically works with <code>GROUP BY</code>. Perhaps we’re only interested in days that had more than 100 checkouts. Let’s see what that looks like:</p>
<pre><code>SELECT 
    loan_date, 
    COUNT(item_id) AS books_checked_out
FROM checkouts
GROUP BY loan_date
HAVING COUNT(item_id) &gt; 100
ORDER BY books_checked_out DESC;</code></pre>
<p>Now we’ve seen how we can use functions to aggregate data and how grouping data can give us meaningful insights. There are, of course, other functions available in SQL and we can’t go over all of them here, but now you’ve seen how they work and can apply your knowledge to new functions you find.</p>
</div>
</div>
<div id="joining-data" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Joining Data<a href="hands-on-with-sql-code.html#joining-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Joining tables allows us to combine information from more than one table into a new table. The tables need to have a <strong><em>key</em></strong> column to be able to link the tables together. A key is a column that contains information that allows it to relate to information in another table. In our Library Checkouts ERD, the <em>item_id</em> column in <em>itmes</em> is a key column that links to <em>item_id</em> in <em>checkouts</em>.</p>
<div id="join-types" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> JOIN Types<a href="hands-on-with-sql-code.html#join-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SQL has 4 main kinds of joins:</p>
<p><img src="https://www.w3schools.com/sql/img_innerjoin.gif" alt="INNER JOIN" /> <img src="https://www.w3schools.com/sql/img_leftjoin.gif" alt="LEFT JOIN" /></p>
<p><img src="https://www.w3schools.com/sql/img_rightjoin.gif" alt="RIGHT JOIN" /> <img src="https://www.w3schools.com/sql/img_fulljoin.gif" alt="FULL OUTER JOIN" /></p>
<blockquote>
<p><strong>NOTE</strong>:<br />
The above images come from the <a href="https://www.w3schools.com/sql/sql_join.asp">W3Schools’ SQL join page</a>, an excellent resource for learning more about SQL.</p>
</blockquote>
<p>What kinds of joins are there?</p>
<ul>
<li><p><code>INNER JOIN</code>: Returns rows that have matching values in both tables; it gets you what’s in the middle of the venn diagram.</p></li>
<li><p><code>LEFT JOIN</code>: Returns all rows from the left table, and the matched rows from the right table; the “left” table is the first table you write in the query.</p></li>
<li><p><code>RIGHT JOIN</code>: Returns all rows from the right table, and the matched rows from the left table; the “right” table is the second table you write in the query or the “join” table.</p>
<blockquote>
<p><strong>NOTE</strong>:<br />
This is not supported in SQLite, however switching the tables in a <code>LEFT JOIN</code> will emulate a <code>RIGHT JOIN</code>.</p>
</blockquote></li>
<li><p><code>FULL OUTER JOIN</code>: Returns all rows when there is a match in either left or right table; nulls are generated in the table when a row in one table doesn’t have a match in the other table.</p>
<blockquote>
<p><strong>NOTE</strong>:<br />
This is not supported in SQLite, however you can emulate a <code>FULL OUTER JOIN</code> described <a href="https://www.sqlitetutorial.net/sqlite-full-outer-join/">here</a>.</p>
</blockquote></li>
</ul>
</div>
<div id="join-steps" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> JOIN steps<a href="hands-on-with-sql-code.html#join-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>JOIN queries typically take this form:</p>
<pre><code>SELECT 
  left_table.column1,
  right_table.column1,
  ...
FROM left_table
  [INNER | LEFT] JOIN right_table ON left_table.key_column = right_table.key_column;</code></pre>
<p>Below are the steps for writing a JOIN:</p>
<ol style="list-style-type: decimal">
<li><code>SELECT</code> the columns we want in the output. Be sure to refer to the columns using their table name (table.column) to disambiguate columns with the same name in two or more tables, like our <em>item_id</em> columns.</li>
<li>The <code>FROM</code> statement indicates which table to start with (this is our “left” table).</li>
<li>The <code>JOIN</code> statement indicates which table should get joined (this is our “right” table). Before the keyword <code>JOIN</code>, you can specify the direction of the join such as <code>INNER</code>, <code>LEFT</code>, or <code>RIGHT</code>.</li>
<li>Finally, we indicate which columns the join should be based on with <code>ON</code>. The columns you choose here should contain information tha allows you to match records (rows) between the two tables.</li>
</ol>
</div>
<div id="inner-join" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> INNER JOIN<a href="hands-on-with-sql-code.html#inner-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s try an <code>INNER JOIN</code> to see how this works:</p>
<pre><code>SELECT 
    items.item_id,
    items.title,
    checkouts.item_id,
    checkouts.due_date
FROM checkouts
INNER JOIN items ON items.item_id = checkouts.item_id;</code></pre>
<p>We interpret the <code>INNER JOIN</code> query as, “all books that have been checked out.”</p>
</div>
<div id="left-join" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> LEFT JOIN<a href="hands-on-with-sql-code.html#left-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s try a <code>LEFT JOIN</code>:</p>
<pre><code>SELECT
    items.item_id,
    items.title,
    checkouts.item_id,
    checkouts.due_date
FROM checkouts
LEFT JOIN items ON items.item_id = checkouts.item_id;</code></pre>
<p>We interpret the <code>LEFT JOIN</code> query as, “all books and if they have been checked out or not.”</p>
<p>You might be thinking, what would happen if the tables in the <code>LEFT JOIN</code> were flipped? We would get the same result as the <code>INNER JOIN</code> query! That’s because there’s no instances where a checkout without a book could ever happen!</p>
<blockquote>
<p><strong>CHALLENGE</strong>:<br />
Can you write a query that contains the title of the books and the ID of the patrons that checked them out?</p>
</blockquote>
</div>
</div>
<div id="subqueries" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Subqueries<a href="hands-on-with-sql-code.html#subqueries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far we’ve been working with one <code>SELECT</code> statement, but we can actually combine multiple <code>SELECT</code> statements using subqueries. Subqueries are nested queries enclosed in parentheses that can be used with other keywords like <code>JOIN</code> and <code>WHERE</code>. Below are 2 examples of these use cases.</p>
<p>You can think of a subquery as a process where you write a query to create a table,, then query the table you just constructed. This can be especially helpful with large complex tables where simplifying helps you understand the query better, or when you need to complete a multi-step query and don’t want to make extra tables or views (something we’ll cover in the next sections).</p>
<p>Let’s first look at a subquery in the <code>WHERE</code> clause:</p>
<pre><code>-- main query
SELECT * 
FROM checkouts 
WHERE item_id IN (
    
    -- subquery
    
    SELECT item_id
    FROM items
    WHERE resource_type = &#39;Microforms&#39;
);</code></pre>
<p>We retrieved microforms in a subquery. We then use the results of the subquery to filter the <em>checkouts</em> table using <em>checkouts.item_id</em>. In the end we get, “all checked out microforms.”</p>
<blockquote>
<p><strong>NOTE</strong>:<br />
When writing a subquery with <code>WHERE</code> and <code>IN</code>, the subquery must select only one column for <code>IN</code> to filter on.</p>
</blockquote>
<p>Now let’s look at a subquery with <code>JOIN</code>:</p>
<pre><code>SELECT 
    -- get the columns we want from both tables
    checkouts.patron_id,
    microforms.title,
    checkouts.loan_date,
    checkouts.due_date
FROM checkouts
INNER JOIN (
    -- subquery to get all the items in microform format
    SELECT *
    FROM items
    WHERE resource_type = &#39;Microforms&#39;
) AS microforms ON checkouts.item_id = microforms.item_id;</code></pre>
<p>We retrieved microforms in a subquery, just like before. Next, we write the subquery after <code>JOIN</code> and alias it <em>microforms</em>. Finally, we join on the keys and return the columns we want in the main <code>SELECT</code> statement. Both subquery examples are just different ways to get to the same result, “checked out hardcover books.”</p>
<blockquote>
<p><strong>NOTE</strong>:<br />
Why would you want to make such a complex query? First, the sub query can help us limit large or complex tables, or join data before we query it. Second, subqueries give you the ability to create a “new” table on the fly, even if that table didn’t exist in the database before, without having to save it.</p>
</blockquote>
</div>
<div id="saving-query-results" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Saving Query Results<a href="hands-on-with-sql-code.html#saving-query-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There will be times when we want to save the results of a query so we can reuse it later when needed. Two commands to save a query as a new database object follow:</p>
<ol style="list-style-type: decimal">
<li><code>CREATE TEMPORARY TABLE</code>
<ul>
<li>This is a new table added to the database, just like the tables you’ve been working with, except it is only available in the current session. You typically do this to break down a complex problem into intermediate steps and pass your saved results to the final query.</li>
</ul></li>
<li><code>CREATE VIEW</code>
<ul>
<li>A view is simply a saved query that can be executed when called. The query you save will usually be made up of multiple tables with added conditions if needed. You can use it in pretty much the same way you would a table. The only major difference is that a view, because it is updating from other tables, is not able to be edited.</li>
</ul></li>
</ol>
<p>If we want to create a temporary table, we just need to add <code>CREATE TEMPORARY TABLE our_new_table_name AS</code> at the beginning of the query (adding in our own table name, of course). This is what it looks like:</p>
<pre><code>CREATE TEMPORARY TABLE mircoform AS
    SELECT 
        -- get the columns we want from both tables
        checkouts.patron_id,
        microforms.title,
        checkouts.loan_date,
        checkouts.due_date
    FROM checkouts
    INNER JOIN (
        -- subquery to get all the items in microform format
        SELECT *
        FROM items
        WHERE resource_type = &#39;Microforms&#39;
    ) AS microforms ON checkouts.item_id = microforms.item_id;</code></pre>
<p>In much the same way we made the new table, we can make a view:</p>
<pre><code>CREATE VIEW mircoform AS
    SELECT 
        -- get the columns we want from both tables
        checkouts.patron_id,
        microforms.title,
        checkouts.loan_date,
        checkouts.due_date
    FROM checkouts
    INNER JOIN (
        -- subquery to get all the items in microform format
        SELECT *
        FROM items
        WHERE resource_type = &#39;Microforms&#39;
    ) AS microforms ON checkouts.item_id = microforms.item_id;</code></pre>
<div id="connecting-databases-to-other-analysis-tools" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Connecting Databases to Other Analysis Tools<a href="hands-on-with-sql-code.html#connecting-databases-to-other-analysis-tools" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="export-tables" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Export Tables<a href="hands-on-with-sql-code.html#export-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>SQLiteStudio has the ability to export out query results to CSV files for further analysis.</p>
<p>Click the “Export” icon <img src="images/sqlitestudio-export-icon.png" /> at the top of the interface and
follow the export dialog.</p>
<p><img src="images/sqlitestudio-export-dialog.png" /></p>
</div>
<div id="programming-language-connections" class="section level4 hasAnchor" number="4.6.1.2">
<h4><span class="header-section-number">4.6.1.2</span> Programming Language Connections<a href="hands-on-with-sql-code.html#programming-language-connections" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Programming languages like R and Python can connect to, read data from, and query your SQL database from your script through additional libraries.</p>
</div>
</div>
</div>
<div id="data-management" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Data Management<a href="hands-on-with-sql-code.html#data-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="update-tables" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Update Tables<a href="hands-on-with-sql-code.html#update-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You might have noticed at the beginning the <em>items</em> table has <em>NULL</em> values across different columns. We can fix this fairly easily, but we need to be careful. It’s challenging to undo something in a database so we want to be sure we’re doing it right. Let’s update the <em>NULL</em> values in the <em>items.receiving_date</em> column to “<em>N/A</em>”.</p>
<p>It’s first helpful to write a query to be sure these are the rows you want to update:</p>
<pre><code>SELECT *
FROM items
WHERE receiving_date IS NULL;</code></pre>
<p>Once you’ve confirmed, the below statement updates the <em>NULL</em> values to “<em>N/A</em>”</p>
<pre><code>UPDATE items
SET receiving_date = &#39;N/A&#39;
WHERE receiving_date IS NULL;</code></pre>
<p>The <code>SET</code> keyword specifically targets just the <em>receiving_date</em> column and replaces <em>NULL</em> values with “<em>N/A</em>” when the condition is met in the <code>WHERE</code> clause. It leaves the other values alone. If the <code>WHERE</code> clause is removed, it will set all values in the whole column to “<em>N/A</em>” overwriting the users address, so proceed with caution!</p>
</div>
<div id="add-populate-a-column" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Add &amp; Populate a Column<a href="hands-on-with-sql-code.html#add-populate-a-column" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes we want to make a new column and add data into it. Let’s make a new column called <em>year</em> in the <em>patrons</em> table and populate it with the year parsed from the <em>creation_date</em> column.</p>
<p>First we’ll add the column and set the default value to “<em>N/A</em>”:</p>
<pre><code>ALTER TABLE patrons
ADD year INTEGER DEFAULT &#39;N/A&#39;;</code></pre>
<blockquote>
<p><strong>NOTE</strong>:<br />
The <code>DEFAULT</code> argument is optional, but if you leave it blank, it will make the default value <em>NULL</em>.</p>
</blockquote>
<p>Now we update all values with the results of a string parsing cution that returns the year from our <em>created_date</em> string. SQLite has time-date functions, but the date format of our data is not the format SQLite prefers, so when something like this happens, you need to get a little creative to get the information you want.</p>
<pre><code>UPDATE patrons
SET year = substr(creation_date, -4, 4)
WHERE state IS NOT NULL;</code></pre>
<p>The function substr() creates a substring from a string object - in this case, our <em>creation_date</em> string. The second argument, -4, indicates the position to start the substring from. Negative values tell the function to start from the right side of the string (or the end of the string) rather than the left. Finally, the third argument indicates how many characters to include. We chose 4 because our date string has a 4 digit year.</p>
<p>Want to see what our update query did?</p>
<pre><code>SELECT * FROM patrons;</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="database-set-up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_intro_to_sql/edit/master/04_hands-on-with-sql-code.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_intro_to_sql/blob/master/04_hands-on-with-sql-code.Rmd",
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
